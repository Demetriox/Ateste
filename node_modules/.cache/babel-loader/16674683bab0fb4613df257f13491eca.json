{"ast":null,"code":"import * as React from 'react';\nimport { user } from 'rxfire/auth';\nimport { preloadAuth, preloadObservable, useAuth, useObservable } from '..';\nimport { from } from 'rxjs';\nexport function preloadUser(firebaseApp) {\n  return preloadAuth(firebaseApp).then(function (auth) {\n    var result = preloadObservable(user(auth()), 'auth: user');\n    return result.request.promise;\n  });\n}\nexport function useUser(auth, options) {\n  auth = auth || useAuth()();\n  var currentUser = undefined;\n  if (options && options.startWithValue !== undefined) {\n    currentUser = options.startWithValue;\n  } else if (auth.currentUser) {\n    currentUser = auth.currentUser;\n  }\n  return useObservable(user(auth), 'auth: user', currentUser);\n}\nexport function useIdTokenResult(user, forceRefresh) {\n  if (forceRefresh === void 0) {\n    forceRefresh = false;\n  }\n  if (!user) {\n    throw new Error('you must provide a user');\n  }\n  var idToken$ = from(user.getIdTokenResult(forceRefresh));\n  return useObservable(idToken$, user.uid + \"-claims\");\n}\nexport function ClaimsCheck(_a) {\n  var user = _a.user,\n    fallback = _a.fallback,\n    children = _a.children,\n    requiredClaims = _a.requiredClaims;\n  var claims = useIdTokenResult(user, false).claims;\n  var missingClaims = {};\n  Object.keys(requiredClaims).forEach(function (claim) {\n    if (requiredClaims[claim] !== claims[claim]) {\n      missingClaims[claim] = {\n        expected: requiredClaims[claim],\n        actual: claims[claim]\n      };\n    }\n  });\n  if (Object.keys(missingClaims).length === 0) {\n    return React.createElement(React.Fragment, null, children);\n  } else {\n    return React.createElement(React.Fragment, null, fallback);\n  }\n}\nexport function AuthCheck(_a) {\n  var auth = _a.auth,\n    fallback = _a.fallback,\n    children = _a.children,\n    requiredClaims = _a.requiredClaims;\n  var user = useUser(auth);\n  if (user) {\n    return requiredClaims ? React.createElement(ClaimsCheck, {\n      user: user,\n      fallback: fallback,\n      requiredClaims: requiredClaims\n    }, children) : React.createElement(React.Fragment, null, children);\n  } else {\n    return React.createElement(React.Fragment, null, fallback);\n  }\n}","map":{"version":3,"names":["React","user","preloadAuth","preloadObservable","useAuth","useObservable","from","preloadUser","firebaseApp","then","auth","result","request","promise","useUser","options","currentUser","undefined","startWithValue","useIdTokenResult","forceRefresh","Error","idToken$","getIdTokenResult","uid","ClaimsCheck","_a","fallback","children","requiredClaims","claims","missingClaims","Object","keys","forEach","claim","expected","actual","length","createElement","Fragment","AuthCheck"],"sources":["/Users/jesusdemetriocontrerascarrillo/Desktop/newAtrevete/node_modules/reactfire/auth/index.js"],"sourcesContent":["import * as React from 'react';\nimport { user } from 'rxfire/auth';\nimport { preloadAuth, preloadObservable, useAuth, useObservable } from '..';\nimport { from } from 'rxjs';\nexport function preloadUser(firebaseApp) {\n    return preloadAuth(firebaseApp).then(function (auth) {\n        var result = preloadObservable(user(auth()), 'auth: user');\n        return result.request.promise;\n    });\n}\nexport function useUser(auth, options) {\n    auth = auth || useAuth()();\n    var currentUser = undefined;\n    if (options && options.startWithValue !== undefined) {\n        currentUser = options.startWithValue;\n    }\n    else if (auth.currentUser) {\n        currentUser = auth.currentUser;\n    }\n    return useObservable(user(auth), 'auth: user', currentUser);\n}\nexport function useIdTokenResult(user, forceRefresh) {\n    if (forceRefresh === void 0) { forceRefresh = false; }\n    if (!user) {\n        throw new Error('you must provide a user');\n    }\n    var idToken$ = from(user.getIdTokenResult(forceRefresh));\n    return useObservable(idToken$, user.uid + \"-claims\");\n}\nexport function ClaimsCheck(_a) {\n    var user = _a.user, fallback = _a.fallback, children = _a.children, requiredClaims = _a.requiredClaims;\n    var claims = useIdTokenResult(user, false).claims;\n    var missingClaims = {};\n    Object.keys(requiredClaims).forEach(function (claim) {\n        if (requiredClaims[claim] !== claims[claim]) {\n            missingClaims[claim] = {\n                expected: requiredClaims[claim],\n                actual: claims[claim]\n            };\n        }\n    });\n    if (Object.keys(missingClaims).length === 0) {\n        return React.createElement(React.Fragment, null, children);\n    }\n    else {\n        return React.createElement(React.Fragment, null, fallback);\n    }\n}\nexport function AuthCheck(_a) {\n    var auth = _a.auth, fallback = _a.fallback, children = _a.children, requiredClaims = _a.requiredClaims;\n    var user = useUser(auth);\n    if (user) {\n        return requiredClaims ? (React.createElement(ClaimsCheck, { user: user, fallback: fallback, requiredClaims: requiredClaims }, children)) : (React.createElement(React.Fragment, null, children));\n    }\n    else {\n        return React.createElement(React.Fragment, null, fallback);\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}